## 页面

### 采集任务

甲方信息管理
团体信息管理

采集任务列表
新建公网任务 --> 拆分和发布团体任务
审核验收

/login/checkManagerLogin
/login/checkConsumerLogin
/login/checkOrganizationLogin

#### 状态
> 任务包,针对sd_collect_task表中的整体任务状态值的修改:
1已发布(平台管理员发布)->2已开始(团队管理员接收或到时自动修改)->3已满额->4待审核(团队管理员提交任务)->5审核失败(平台管理员审核)->6审核成功(平台管理员审核)->->7待验收(平台管理员提交)->8验收失败(甲方管理员验收)->9验收成功(甲方管理员验收)->10已结算->11废弃

------



> 单条任务，针对sd_collect表中单条任务状态值的修改：
1已开始->2暂存->3待检验(团队成员提交)->4检验失败(团队管理员检验)->5检验成功(团队管理员检验)->6待审核(公网任务提交)->7审核失败(平台管理员审核)->8审核成功(平台管理员审核)->9验收失败(甲方管理员验收)->10验收成功(甲方管理员验收)->11已结算




##### 管理员

发布任务成功 -> 1
每天查库时间查询当前时间 >= 任务开始时间 -> 2 
公网用户单个提交 -> 6
管理员审核公网用户单个任务/代理商提交任务 -> 7/8
管理员将单个任务审核成功数量达标 -> 9 
管理员提交任务 -> 10


##### 代理商  

领取任务 -> 2 
团队成员提交任务 -> 3 
代理商检验 -> 4/5 
代理商提交任务，验证任务完成  -> 6



##### 甲方 

单个任务管理员审核成功数达到目标 -> 10 
验收任务 -> 11/12
结算成功 -> 14 


----


列表id除管理员以外做成属性 data-id="1"
代理商可以查看团队成员审核状态



## 用户分类 (4类)

头像上传暂不做，先走业务流程

### 散户 user

用户头像 PC微信端共享
微信小程序openid获取

1.0 PC端注册——>登陆——>编辑个人信息
2.0 微信端扫码注册登陆
3.0 PC端注册好，编辑信息的时候微信扫码关联个人信息 


### 甲方 consumer 

头像默认，不更改
需求方

### 组织 organization_user
默认头像，
任务接收——>任务分发


### 管理员 manager
任务整理分发



---

#### 本周待解决问题 9/11 - 9/15
1. 接口更改 
2. 首要目标确保整个流程走通
3. 代理商、客户名称统一，列表id项替换为序号，核对两方权限显示对应项
4. 代理商提交至管理员审核、管理员提交至甲方验收页面
5. 提交表单的验证，及数据类型核对
6. 日期格式转换更改
7. 图片审核部分完善
8. 其它细节更改
9. 列表id除管理员以外做成属性 data-id="1"
10. 代理商可以查看团队成员审核状态
11. 方法封装


代理商可以查看团队成员审核状态
子任务作为父任务的展开项，预定实现
 
-----
### 已完成部分

【登陆】 接口

管理员->
【数据采集】
任务列表
  任务详情、编辑、拆分
  任务详情 =>  增加管理员提交验收
              状态位置更改、增加已完成数（团队、甲方未更改）
数据审核
  任务列表、图片审核、音频审核
发布任务

【客户管理】
客户列表
  列表->修改、删除
新增客户


【代理商管理】
代理商列表
  列表->修改、删除
  
新增代理商


-----
### 小程序问题

1. 搜索团队需要搜索两次才能有结果
2. 登陆部分，获取验证码按钮不容易点中
3. 试听录音只能试听一次
4. 加入团队点击确认后页面无跳转
5. 切换tab时，显示暂无数据提示




#### 下周待解决问题 9/17-9/21

1. 管理员抽检团队任务，审核是否成功评判机制 
2. 检验不通过流程
3. 甲方验收任务，审核是否成功评判机制
4. 管理员提交至甲方判断：
   后端返回状态，判断是否可以进行提交，取代以下代码
   taskData.sumCount>=taskData.count && taskData.status ==5 && taskData.parentId === null

##### 管理员抽检团队任务，审核评判机制




### 新增页面
团队管理员可以查看成员审核状态
首页展示

成员信息  采集任务  标注任务（暂无）

列表                     团队信息


tab切换 
  1. 列表信息
  2. 饼图统计

列表内容 -> 见后台参数




审核页 -> 审核用户申请加入的信息


#### 本周已完成 9/17-9/21
1. 团队管理员是否能提交审核任务的评判机制
2. 团队管理员旗下所有列表的ID列 -> 名称下data-id属性
3. 团队管理员查看成员审核状态、任务审核情况
4. 团队管理员进入后台首页
.管理员审核整条团队任务 -> 先默认手动选择通过或不通过
5. 审核任务列表显示不完全 


#### 数据图表

管理员首页团员人数 任务饼图  /api/manager/findSysInfo


审核机制，固定概率（暂定）
语音上传与图片一样，数量不唯一
语音限制时长区间
审核失败是否可以重新做，重做次数（个人与团队任务）
单个任务适合可接多次

开发任务
聊天
聚餐

发布任务 -> if(type === 2) => 新增 任务时常、 任务条数 -> (单条/多条)
 -> 
ruleCount    约束数量
ruleTime      约束时长

录音时长 最少15s， 最多60s  【发布任务】

成员姓名 用户名 昵称
微信登陆获取只有成员姓名、昵称


服务器迁移到正式服务器上
代理商任务不通过时
学习node



## 流程更改 

#### 状态更改 
1. 已满额(status=3) + 
任务剩余次数==0 状态为已满额


#### 字段更改 
1. 已完成数 doneNum -
2. 任务剩余次数 residue_count +
3. 任务提交数量 doneNum + 
4. 抽检比例 ruleCheck +
5. 错误比例 ruleError +



小程序端任务剩余次数 = residue_count - doneNum

1. doneNum 
公网用户提交 -> doneNum +1 ( doneNum==residue_count?status = 3:status = 2 )
单条任务审核失败 -> doneNum -1  ( status = 2 已开始 )
status由8改为2时（验收失败->已开始） -> {
  residue_count=所有验收失败的单条任务
  doneNum=0
}

2. residue_count
任务发布 --> residue_count = surplusNum(任务份额总数)
任务拆分 --> residue_count = surplusNum
status由8改为2时（验收失败->已开始） -> {
  residue_count=所有验收失败的单条任务
  doneNum=0
}



单条任务验收成功的情况下，验收列表显示状态验收成功的可以查看但是不能操作

Q 任务改变状态重新开始后，可以直接提交
验收失败的单条任务仍然存在已完成数内

废弃主任务时 --> 子任务一起废弃

团队任务显示
已开始 --> 已开始
验收成功 --> 审核成功
待审核-审核成功-待验收-验收失败 --> 待审核
审核失败 --> 审核失败
废弃 --> 废弃

#### 验收失败详情页面

验收失败详情列表 ->   姓名 昵称 ID 提交时间 所属团队
验收失败占比图 -> 散户总数   团队A总数 团队B总数...


操作
公网任务 ->    重做 废弃此任务 --> 整个任务废弃 （Tip：主任务废弃时，对应的子任务也将全部废弃）
子任务A ->     重做 废弃此任务 --> 总数回到主任务
子任务B ->     重做 废弃此任务 --> 总数回到主任务

公网任务 -> 任务名 ID 不通过总数 任务份额总数 通过率 操作
团队任务 -> 任务名 ID 不通过总数 任务总数 通过率 操作


查看失败详情按钮
-> 主任务
    失败详情
-> 子任务
    编辑





<!-- 管理员状态修改页面
首页
任务列表 -> 列表 编辑 验收失败详情 任务详情页 拆分
发布任务 
数据审核  -->

